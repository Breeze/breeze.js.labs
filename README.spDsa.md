SharePoint Data Service Adapter
===============================
This is used to provide BreezeJS support for SharePoint 2013. See [Andrew Connell's fork](https://github.com/andrewconnell/breeze.js.labs) for a current development of the SharePoint data service adapter, including the [issues list](https://github.com/andrewconnell/breeze.js.labs/issues) for bugs, future plans & milestones.



Installation
------------
The Breeze data service adapter for SharePoint is provided as a single NuGet Package that includes everything you need to use it in a SharePoint 2013 project.

````powershell
Install-Package "Breeze.DataService.SharePoint"
````



Setup
-----
1. Configure BreezeJS SharePoint data service adapter
1. Create & populate the BreezeJS metadata store
1. Initialize BreezeJS



###Step 1 - Configure SharePoint Data Service Adapter
````javascript
// configure breeze to use SharePoint OData service
var dsAdapter = breeze.config.initializeAdapterInstance('dataService', 'SharePointOData', true);

// tell breeze how to get the security validation token for
//  HTTP POST & DELETE calls
// NOTE: Setting the request digest is not required when using OAuth tokens for authentication. The request digest is used when cookies are used for authentication to protect against XSRF. When OAuth tokens are used, there is no XSRF issue as there are no cookies. Version 0.6.3 of the adapter added conditional logic to omit the `X-RequestDigest` header in the HTTP request if this method is not set.
dsAdapter.getRequestDigest = function () {
  return jQuery('#__REQUESTDIGEST').val();
};
````



###Step 2 - Create & Populate the BreezeJS Metadata Store
````javascript
// create a new breeze metadata store
metadataStore = new breeze.MetadataStore();

// setup a helper to create entities
var namespace = '';
var helper = new breeze.config.MetadataHelper(namespace, breeze.AutoGeneratedKeyType.Identity);

// create entity for contacts
var contactEntity = {
  name: 'Contacts',
  defaultResourceName: 'getbytitle(\'Contacts\')/items',
  dataProperties: {
    Id: { type: breeze.DataType.Int32 },
    FirstName: { nullable: false },
    Title: { nullable: false },  // this is actually the last name field in the list
    Email: {
      nullable: false,
      validators: [breeze.Validator.emailAddress()]
    }
  }
};

// add entity to metadata store
helper.addTypeToStore(metadataStore, contactEntity);
````

> Note that it is very important that the **name** of the entity matches exactly the name of the SharePoint list the entity is coming from. If it doesn't Breeze will not be able to associate data from an HTTP GET it makes with the entity defined in the metadata store.



###Step 3 - Initialize BreezeJS
````javascript
// get reference to contact entity type
contactType = metadataStore.getEntityType('Contacts');

// create the data service
var dataService = new breeze.DataService({
  // tell breeze the root REST endpoint to use
  //  since we only are using lists, point to that
  serviceName: _spPageContextInfo.webAbsoluteUrl + '/_api/web/lists/',
  // tell breeze not to interrogate sharepoint for it's
  //  massive OData $metadata response... we created it manually
  hasServerMetadata: false
});

// create an instance of the entity manager
entityManager = new breeze.EntityManager({
  dataService: dataService,
  // tell breeze where the metadata is
  metadataStore: metadataStore
});
````



Supports
--------
- SharePoint 2013
  + Office 365 / SharePoint Online: RTM -> present version
  + SharePoint 2013 On-Premises: RTM -> present version
- SharePoint 2010
  + Not supported *at the present time*
- SharePoint 2007
  + Support not planned



References
----------
> - Documentation on the BreezeJS site for more information & background: [BreezeJS.com - SharePoint SPA](http://www.breezejs.com/samples/introduction-single-page-apps-sharepoint)
> - [Andrew Connell's](http://www.andrewconnell.com) session on using BreezeJS with SharePoint: [BreezeJS Makes Client-Side SharePoint 2013 REST Development a... BREEZE!](https://github.com/andrewconnell/pres-sp15rest-breeze).
